Version: 2

vars:
  AppName: "Foo"
tasks:
  RemoveHeartBeat: docker exec {{.AppName}} rm /tmp/heartbeat.txt
  AnnounceStart:
    Hipchat:
      Msg: Starting deploy on {{.Host}}
  Verify:
    Plugin: Verify
    Endpoint: /v1/baz
    Timeout: 200
  Start: docker start {{.AppName}}
  Stop:
    Runner: Remote
    User: super
    Command: docker stop {{.AppName}}
  Deploy:
    - RemoveHeartBeat
    - Stop
    - Start
    - TouchHeartbeat
Plugins:
  - Hipchat:
    Endpoint:
    Room:
Remote:
  Staging:
    User: deploy
    Hosts:
      - foo.bar
Environment:
  User: deploy
  Staging:
    User: staging-deploy
    Hosts:
      - my-app1.com
      - my-app2.com
    Vars:
      JRubyOpts: -J-Xmn5376m -J-Xms7168m -J-Xmx7168m
