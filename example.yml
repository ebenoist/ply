Version: 1

Vars:
  AppName: "Foo"
Tasks:
  RemoveHeartBeat: docker exec {{.AppName}} rm /tmp/heartbeat.txt
  TouchHeartbeat: docker exec {{.AppName}} touch /tmp/heartbeat.txt
  AnnounceStart:
    Plugin: Hipchat
    Msg: Starting deploy on {{.Host}}
  Verify:
    Plugin: Verify
    Endpoint: /v1/baz
    Timeout: 200
  Start: docker start {{.AppName}}
  Stop:
    Plugin: Remote
    User: super
    Command: docker stop {{.AppName}}
  Deploy:
    - RemoveHeartBeat
    - Stop
    - Start
    - TouchHeartbeat
Plugins:
  Hipchat:
  Verify:
Environments:
  User: deploy
  Staging:
    User: staging-deploy
    Hosts:
      - my-app1.com
      - my-app2.com
    Vars:
      JRubyOpts: -J-Xmn5376m -J-Xms7168m -J-Xmx7168m


